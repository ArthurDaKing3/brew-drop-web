--===== DRINKS =====--
CREATE TABLE IF NOT EXISTS Drink (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    name NVARCHAR(50) NOT NULL,
    image NVARCHAR(50),
    price INTEGER NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME 
);
INSERT INTO Drink VALUES(1,'Latte','latte.png',60.0,'2024-08-24',NULL);
INSERT INTO Drink VALUES(2,'Frappe Mocha','latte.png',70.0, '2024-08-24',NULL);
INSERT INTO Drink VALUES(3,'Macchiato','latte.png',70.0, '2024-08-24',NULL);

--===== CATEGORY =====--
CREATE TABLE IF NOT EXISTS Category (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    name NVARCHAR(50) NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME 
);
INSERT INTO Category VALUES(1,'Frio','2024-08-24',NULL);
INSERT INTO Category VALUES(2,'Caliente','2024-08-24',NULL);
INSERT INTO Category VALUES(3,'Espresso Bar','2024-08-24',NULL);
INSERT INTO Category VALUES(4,'Frappe','2024-08-24',NULL);

--===== MILK TYPE =====--
CREATE TABLE IF NOT EXISTS MilkType (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    name NVARCHAR(50) NOT NULL,
    price INTEGER NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME 
);
INSERT INTO MilkType VALUES(1,'Entera',0.0,'2024-08-24',NULL);
INSERT INTO MilkType VALUES(2,'Deslactosada',0.0,'2024-08-24',NULL);
INSERT INTO MilkType VALUES(3,'Almendras',0.0,'2024-08-24',NULL);

--===== SIZE =====--
CREATE TABLE IF NOT EXISTS Size (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    name NVARCHAR(50) NOT NULL,
    priceMultiplier INTEGER NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME 
);
INSERT INTO Size VALUES(1,'12 oz.',0.0,'2024-08-24',NULL);
INSERT INTO Size VALUES(2,'16 oz.',5.0,'2024-08-24',NULL);
INSERT INTO Size VALUES(3,'20 oz.',10.0,'2024-08-24',NULL);

--===== DISCOUNT =====--
CREATE TABLE IF NOT EXISTS Discount (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    description NVARCHAR(50) NOT NULL,
    percentage INTEGER NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME 
);
INSERT INTO Discount VALUES(1,'Vinanti',10,'2024-08-24',NULL);
INSERT INTO Discount VALUES(2,'Other Discount',5,'2024-08-24',NULL);

--===== CATEGORY DRINK =====--
CREATE TABLE IF NOT EXISTS _CategoryToDrink (
    A INTEGER NOT NULL,
    B INTEGER NOT NULL,
    CONSTRAINT _CategoryToDrink_A_fkey FOREIGN KEY (A) REFERENCES Category (id) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT _CategoryToDrink_B_fkey FOREIGN KEY (B) REFERENCES Drink (id) ON DELETE CASCADE ON UPDATE CASCADE
);
INSERT INTO _CategoryToDrink VALUES(1,1);
INSERT INTO _CategoryToDrink VALUES(2,1);
INSERT INTO _CategoryToDrink VALUES(3,1);
INSERT INTO _CategoryToDrink VALUES(1,2);
INSERT INTO _CategoryToDrink VALUES(4,2);
INSERT INTO _CategoryToDrink VALUES(1,3);
INSERT INTO _CategoryToDrink VALUES(3,3);

CREATE UNIQUE INDEX _CategoryToDrink_AB_unique ON _CategoryToDrink(A, B);
CREATE INDEX _CategoryToDrink_B_index ON _CategoryToDrink(B);

--===== SALE MASTER =====--
CREATE TABLE IF NOT EXISTS SaleMaster (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    total INTEGER NOT NULL,
    payment NVARCHAR(50) NOT NULL DEFAULT 'Efectivo',
    discountId INTEGER,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME,
    CONSTRAINT SaleMaster_discountId_fkey FOREIGN KEY (discountId) REFERENCES Discount (id) ON DELETE SET NULL ON UPDATE CASCADE
);

--===== SALE DETAIL =====--
CREATE TABLE IF NOT EXISTS SaleDetail (
    id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    saleMasterId INTEGER NOT NULL,
    drinkId INTEGER NOT NULL,
    drinkType NVARCHAR(50) NOT NULL,
    sizeId INTEGER NOT NULL,
    milkTypeId INTEGER,
    quantity INTEGER NOT NULL,
    createdAt DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updatedAt DATETIME,
    CONSTRAINT SaleDetail_saleMasterId_fkey FOREIGN KEY (saleMasterId) REFERENCES SaleMaster (id) ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT SaleDetail_drinkId_fkey FOREIGN KEY (drinkId) REFERENCES Drink (id) ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT SaleDetail_sizeId_fkey FOREIGN KEY (sizeId) REFERENCES Size (id) ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT SaleDetail_milkTypeId_fkey FOREIGN KEY (milkTypeId) REFERENCES MilkType (id) ON DELETE SET NULL ON UPDATE CASCADE
);